-- database/schema.sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  role VARCHAR(20) CHECK (role IN ('customer','distributor')),
  email TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL
);

CREATE TABLE distributor_profiles (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id),
  company_name TEXT,
  rating FLOAT DEFAULT 0
);

CREATE TABLE fuel_prices (
  id SERIAL PRIMARY KEY,
  distributor_id INT REFERENCES distributor_profiles(id),
  fuel_type VARCHAR(20),
  price_per_litre NUMERIC
);

CREATE TABLE orders (
  id SERIAL PRIMARY KEY,
  customer_id INT REFERENCES users(id),
  distributor_id INT REFERENCES distributor_profiles(id),
  fuel_type VARCHAR(20),
  litres INT,
  payment_status VARCHAR(20) CHECK (payment_status IN ('pending','authorized','captured','refunded','failed'))
);

CREATE TABLE reviews (
  id SERIAL PRIMARY KEY,
  order_id INT REFERENCES orders(id),
  rating INT,
  comment TEXT
);
